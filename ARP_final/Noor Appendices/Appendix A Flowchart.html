<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MND Communication System Architecture</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        .phase {
            width: 100%;
            max-width: 1200px;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            background: #ecf0f1;
            margin-bottom: 20px;
        }
        .phase-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            background: #3498db;
            color: white;
            padding: 10px;
            border-radius: 5px;
        }
        .process-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .process-box {
            flex: 1;
            min-width: 200px;
            margin: 5px;
            padding: 15px;
            background: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            text-align: center;
            position: relative;
        }
        .input-box {
            background: #e8f5e8;
            border-color: #27ae60;
        }
        .process-box-main {
            background: #fff3cd;
            border-color: #f39c12;
        }
        .output-box {
            background: #e3f2fd;
            border-color: #2196f3;
        }
        .evaluation-box {
            background: #fce4ec;
            border-color: #e91e63;
        }
        .arrow {
            font-size: 1.5em;
            color: #3498db;
            margin: 0 10px;
        }
        .data-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .component-details {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 8px;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid #999;
        }
        .error-handling {
            background: #ffebee;
            border: 2px dashed #f44336;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .timing-section {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MND Communication System: Architecture and Evaluation Methodology</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-box input-box"></div>
                <span>Data Input</span>
            </div>
            <div class="legend-item">
                <div class="legend-box process-box-main"></div>
                <span>Processing</span>
            </div>
            <div class="legend-item">
                <div class="legend-box output-box"></div>
                <span>Output</span>
            </div>
            <div class="legend-item">
                <div class="legend-box evaluation-box"></div>
                <span>Evaluation</span>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Phase 1: Data Architecture and Setup</div>
            <div class="data-flow">
                <div class="process-box input-box">
                    <strong>Persona Onboarding Dataset</strong>
                    <div class="component-details">4 personas × 48 attributes<br>Communication preferences, triggers, personality traits</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box process-box-main">
                    <strong>get_persona_row()</strong>
                    <div class="component-details">Case-insensitive matching<br>Accessibility error handling</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box output-box">
                    <strong>Structured Persona Text</strong>
                    <div class="component-details">build_persona_text()<br>Natural language format</div>
                </div>
            </div>
            
            <div class="data-flow">
                <div class="process-box input-box">
                    <strong>Training Datasets</strong>
                    <div class="component-details">90 Q&A pairs per persona<br>3 contexts: Medical, Family, Work</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box process-box-main">
                    <strong>build_examples_blob()</strong>
                    <div class="component-details">Setting-based filtering<br>Few-shot learning examples</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box output-box">
                    <strong>Contextual Examples</strong>
                    <div class="component-details">trim_to_char_budget()<br>60,000 character limit</div>
                </div>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Phase 2: LLM Integration and API Processing</div>
            <div class="process-row">
                <div class="process-box input-box">
                    <strong>User Query Input</strong>
                    <div class="component-details">Communication context<br>Persona selection<br>Response count (1-10)</div>
                </div>
                <span class="arrow">↓</span>
            </div>
            
            <div class="data-flow">
                <div class="process-box process-box-main">
                    <strong>DeepSeek Integration</strong>
                    <div class="component-details">Role-based messaging<br>REST API endpoints<br>JSON payload structure</div>
                </div>
                <div class="process-box process-box-main">
                    <strong>Gemini Integration</strong>
                    <div class="component-details">Concatenated prompts<br>GenerativeAI SDK<br>Built-in retry mechanisms</div>
                </div>
            </div>
            
            <div class="error-handling">
                <strong>Error Handling & Reliability Measures:</strong>
                <div class="component-details">
                    • 180-second timeout management<br>
                    • Response validation protocols<br>
                    • Fallback processing for API failures<br>
                    • Rate limiting compliance<br>
                    • Comprehensive logging system
                </div>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Phase 3: Response Processing and Extraction</div>
            <div class="data-flow">
                <div class="process-box input-box">
                    <strong>Raw LLM Response</strong>
                    <div class="component-details">Unstructured text output<br>Variable formatting</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box process-box-main">
                    <strong>split_numbered_options()</strong>
                    <div class="component-details">Regex pattern matching<br>Two-tier parsing system<br>Fallback mechanisms</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box output-box">
                    <strong>Structured Options</strong>
                    <div class="component-details">Exactly n responses<br>Consistent formatting<br>Quality validation</div>
                </div>
            </div>
            
            <div class="process-row">
                <div class="process-box evaluation-box">
                    <strong>Primary Parsing</strong>
                    <div class="component-details">Comprehensive regex patterns<br>Numbering formats: 1., 2), 3:, •, -</div>
                </div>
                <div class="process-box evaluation-box">
                    <strong>Fallback Parsing</strong>
                    <div class="component-details">Paragraph-based splitting<br>Maintains system reliability<br>Handles format deviations</div>
                </div>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Phase 4: Performance Evaluation Framework</div>
            
            <div class="timing-section">
                <strong>Timing Evaluation Protocol:</strong>
                <div class="data-flow">
                    <div class="process-box evaluation-box">
                        <strong>Response Time Measurement</strong>
                        <div class="component-details">time.time() microsecond precision<br>10 iterations per configuration<br>Network-controlled environment</div>
                    </div>
                    <span class="arrow">→</span>
                    <div class="process-box evaluation-box">
                        <strong>Scalability Assessment</strong>
                        <div class="component-details">1-10 response variants<br>Batch processing (30 questions)<br>Linear vs consistent scaling</div>
                    </div>
                </div>
            </div>
            
            <div class="process-row">
                <div class="process-box evaluation-box">
                    <strong>Quantitative Metrics</strong>
                    <div class="component-details">Flesch Reading Ease<br>Word count compliance<br>Semantic diversity (MiniLM)<br>Success rate measurement</div>
                </div>
                <div class="process-box evaluation-box">
                    <strong>Qualitative Assessment</strong>
                    <div class="component-details">Google Forms survey<br>Blind comparative evaluation<br>Persona consistency review<br>Contextual appropriateness</div>
                </div>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Phase 5: User Interface and Clinical Integration</div>
            <div class="data-flow">
                <div class="process-box input-box">
                    <strong>UI Design Principles</strong>
                    <div class="component-details">AlphaCore Grid Pad inspiration<br>Accessibility guidelines (WCAG 2.1)<br>Large touch targets (60px)<br>High contrast (7:1 ratio)</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box process-box-main">
                    <strong>Multi-Modal Access</strong>
                    <div class="component-details">Touch interface<br>Switch access compatibility<br>Eye-tracking support<br>EMG integration ready</div>
                </div>
                <span class="arrow">→</span>
                <div class="process-box output-box">
                    <strong>Clinical Deployment</strong>
                    <div class="component-details">Real-time response delivery<br>Preview functionality<br>Undo capabilities<br>Progressive disclosure</div>
                </div>
            </div>
        </div>

        <div class="phase">
            <div class="phase-title">Evaluation Results and Clinical Validation Requirements</div>
            <div class="process-row">
                <div class="process-box evaluation-box">
                    <strong>Performance Benchmarks</strong>
                    <div class="component-details">Gemini: 6.62s (30Q batch)<br>DeepSeek: 101.71s (30Q batch)<br>15-fold speed advantage<br>95% vs 87% success rate</div>
                </div>
                <div class="process-box evaluation-box">
                    <strong>User Preference Indicators</strong>
                    <div class="component-details">Preliminary findings (n=4)<br>78% medical preference<br>75% family preference<br>62% work preference</div>
                </div>
                <div class="process-box evaluation-box">
                    <strong>Clinical Validation Needs</strong>
                    <div class="component-details">Minimum n=30 MND patients<br>SLP evaluation required<br>Longitudinal assessment<br>Real-world deployment testing</div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>